{% import _self as menus %}

{#
We call a macro which calls itself to render the full tree.
@see http://twig.sensiolabs.org/doc/tags/macro.html
#}
<nav class="navbar navbar-expand-lg navbar-light">
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

{{ menus.menu_links(items, attributes, 0) }}

{% macro menu_links(items, attributes, menu_level) %}
  {% import _self as menus %}
  {% if items %}
    {% if menu_level == 0 %}
<ul class="collapse navbar-collapse" id="navbarSupportedContent" data-pos="first-ul">
  {% else %}
  <ul data-pos="second-ul" class="navbar-nav mr-auto second-ul-menus">
    {% endif %}
    {% for item in items %}
      {% if item.is_expanded %}
        <li data-pos="if-is-expendable"  class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="{{ item.url }}" data-toggle="dropdown" id="navbarDropdown" role="button" aria-haspopup="true" aria-expanded="false">{{ item.title }}</a>
      {% else %}
        <li data-pos="if-is-expendable-else" class="nav-item">
        {% if item.title in ['E-learning', 'Médiathèque', 'Media library'] %}
          <a href="{{ item.url }}" class="nav-link highlited-main-link">{{ item.title }}</a>
        {% else %}
          <a href="{{ item.url }}" class="nav-link">{{ item.title }}</a>
        {% endif %}
      {% endif %}
      {% if item.below %}
      <div class="dropdown-menu" aria-labelledby="navbarDropdown">
        {#<a class="dropdown-item" href="#">Action</a>#}
        {{ menus.menu_links(item.below, attributes.addClass('dropdown-item', 'bellowelementsabu1'), menu_level + 1) }}
      </div>
      {% endif %}
      </li>
    {% endfor %}
  </ul>
  {% endif %}
  {% endmacro %}
  </div>
  </nav>
